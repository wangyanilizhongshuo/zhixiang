(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopCar/shopCar"],{"34ad":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){n.e("component/css/light7_min").then(function(){return resolve(n("6800"))}.bind(null,n)).catch(n.oe)},a=function(){n.e("component/css/light7_swipeout").then(function(){return resolve(n("e0cf"))}.bind(null,n)).catch(n.oe)},o=function(){n.e("component/css/light7_swiper_min").then(function(){return resolve(n("812e"))}.bind(null,n)).catch(n.oe)},c=function(){n.e("component/css/main").then(function(){return resolve(n("1321"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("component/css/jzl").then(function(){return resolve(n("676a"))}.bind(null,n)).catch(n.oe)},r=function(){n.e("component/css/page/shopCar").then(function(){return resolve(n("b580"))}.bind(null,n)).catch(n.oe)},u={components:{shopCar:r,jzl:s,main:c,light7_swiper_min:o,light7_swipeout:a,light7_min:i},data:function(){return{carList:[],chioceFlag:[],allChoiceFlag:!0,integral:0,sumMoney:0,deleFlag:!0,userId:"",id:"",chooseMove:!1}},onTabItemTap:function(){wx.getStorageSync("user").id||t.navigateTo({url:"/pages/login/login"})},onLoad:function(){this.getCarList()},onShow:function(){this.integral=0,this.sumMoney=0,this.getCarList()},onShareAppMessage:function(){var t=this;return{title:"智享婴品",path:"/pages/index/index?"+t.getShareUrlParams()}},methods:{getCarList:function(){var e=this,n=t.getStorageSync("user").id;t.wjw_http({url:"shoppingcart/list",data:{userId:n}}).then((function(t){if(0==t.status){var n=t.result;1==e.chooseMove?e.carList.map((function(t,e,i){n[e].flagChoice=t.flagChoice,n[e].raisePrice=(n[e].raisePrice/100).toFixed(2)})):n.map((function(t){t.flagChoice=!1,t.raisePrice=(t.raisePrice/100).toFixed(2)})),e.carList=n}})).catch((function(t){console.log(t.msg)}))},calculMoney:function(){var t=this;this.sumMoney=0,this.integral=0;var e=0;this.carList.map((function(n){if(console.log(n),1==n.flagChoice){e+=n.buy_num*n.raisePrice;var i=n.buy_num*n.points;t.integral=t.integral+i,t.keepTwoDecimalFull(e)}})),this.$forceUpdate()},keepTwoDecimalFull:function(t){var e=parseFloat(t);if(isNaN(e))return!1;e=Math.round(100*t)/100;var n=e.toString(),i=n.indexOf(".");i<0&&(i=n.length,n+=".");while(n.length<=i+2)n+="0";this.sumMoney=n},sendNum:function(e,n){var i=this,a=wx.getStorageSync("token"),o=t.getStorageSync("user").id,c=this,s=c.carList[n];t.wjw_http({url:"shoppingcart/update",data:{buy_num:e,userId:o,id:s.id,token:a}}).then((function(t){i.getCarList()}))},choice:function(t){var e=this;e.carList[t].flagChoice=1==e.carList[t].flagChoice?e.$set(e.carList[t],"flagChoice",!1):e.$set(e.carList[t],"flagChoice",!0);var n=e.carList.every((function(t){return 1==t.flagChoice}));e.allChoiceFlag=1!=n,this.calculMoney()},subtraction:function(t){var e=t;0==this.carList[e].buy_num?this.carList[e].buy_num=0:this.carList[e].buy_num-=1,this.chooseMove=!0,this.calculMoney(),this.sendNum(this.carList[e].buy_num,e)},addition:function(t){var e=t;this.carList[e].buy_num<this.carList[e].sub_event_id&&(this.carList[e].buy_num+=1),this.chooseMove=!0,this.calculMoney(),this.sendNum(this.carList[e].buy_num,e)},allChoice:function(){this.allChoiceFlag=1!=this.allChoiceFlag,0==this.allChoiceFlag?this.carList.map((function(t){t.flagChoice=!0})):this.carList.map((function(t){t.flagChoice=!1})),this.calculMoney()},editBtn:function(){this.deleFlag=1!=this.deleFlag},delement:function(){var e=this;this.carList.map((function(n){1==n.flagChoice&&t.showModal({title:"提示",content:"确定删除？",success:function(i){i.confirm?t.wjw_http({url:"shoppingcart/delete/"+n.id,type:"get"}).then((function(t){0==t.status&&e.getCarList()})):i.cancel}})}))},settleMent:function(){var e=[];wx.removeStorageSync("cartBuy"),wx.removeStorageSync("sumMoney"),wx.removeStorageSync("sunJifen");var n=this.carList.every((function(t){return 0==t.flagChoice}));0==n&&(this.carList.map((function(t,n,i){t.flagChoice&&e.push(t)})),wx.setStorageSync("cartBuy",e),wx.setStorageSync("sumMoney",this.sumMoney),wx.setStorageSync("sunJifen",this.integral),t.navigateTo({url:"/pages/confirmorder"}))}}};e.default=u}).call(this,n("543d")["default"])},"41a9":function(t,e,n){"use strict";var i=n("b2a6"),a=n.n(i);a.a},8051:function(t,e,n){"use strict";n.r(e);var i=n("965e"),a=n("e9b8");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("41a9");var c,s=n("f0c5"),r=Object(s["a"])(a["default"],i["b"],i["c"],!1,null,"4776b2ba",null,!1,i["a"],c);e["default"]=r.exports},"965e":function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return i}));var a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},b2a6:function(t,e,n){},e9b8:function(t,e,n){"use strict";n.r(e);var i=n("34ad"),a=n.n(i);for(var o in i)"default"!==o&&function(t){n.d(e,t,(function(){return i[t]}))}(o);e["default"]=a.a},f38b:function(t,e,n){"use strict";(function(t){n("a53d");i(n("66fd"));var e=i(n("8051"));function i(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["f38b","common/runtime","common/vendor"]]]);